Modern urban society relies upon the safe and secure operation of wireless communication links that are part of all modern electronic systems. 
%
From personal devices like smartphones, smartwatches, laptops to public infrastructure like grid equipment, lighting, fuel and transportation systems, wireless ad-hoc links (e.g. Bluetooth and WiFi) are used in a myriad of applications, distributed across metropolitan areas.
%
These links are diverse in not only their applications, but also in their manufacturing -- they use wireless chipsets, circuit boards, and other components from hundreds of different manufacturers.
%
These ad-hoc links allow users within wireless range ability to remotely access and passively monitoring these electronic systems, safely and conveniently at a distance.
%
For example, a maintenance worker need not spend time physically accessing a circuit breaker on a dangerous high voltage line; they can remotely connect to a Bluetooth interface and run diagnostics at a safe distance [cite].
%
Information about exposure to COVID-19 and its spread need not be obtained manually; continuously transmitting BLE beacons enable smartphones to alert users of potential exposure even when at a distance from an infected individual, indoors or outdoors.
%

Unfortunately, this convenience has come at the cost of security and privacy.
%
This "network" of non-Internet connected wireless links has opened up a new threat vector --- attackers can gain unauthorized access or remotely track our electronic devices using these links, covertly from a distance without risk of being caught.
%
For example, researchers have demonstrated remotely accessing and controlling urban infrastructure such as traffic lights at intersections[cite], and circuit breakers on power lines[cite].
%
Several examples of surreptitious tracking of individuals using BLE beacons from smartphones exist in literature[cite] and the real-world.
%
Worse, these links are so convenient that even attackers are implanting their own wireless links to gain illegitimate access to critical infrastructure and track people.
%
For instance, criminals have been installing Bluetooth radios in payment terminals at gas stations and ATMs to commit millions of dollars in fraud.
%
Stalkers have been covertly placing AirTags onto unsuspecting victims, to follow and track them.
%
Securing these wireless links is therefore important to our public health and safety, economy and even national security.

Protecting these wireless access links is important but complicated.
%
These wireless links are distributed over entire metropolitan areas, supporting a diverse set of applications using a wide variety of hardware.
%
We don't have empirical knowledge of future exploitable security issues of these wireless links, or even an insight into what legitimate wireless links are under attack and any illegitimate wireless links that are carrying out attacks.
%
For example, we know there are Bluetooth skimmers out there at several gas stations, but no understanding of how many or where and even if we can find them.
%
Several wireless ad-hoc links across urban areas provide remote access to grid circuit breakers, aviation fuel trucks, speed limit signs; a lot of them are retrofitted into legacy equipment, and therefore are undocumented open interfaces we know nothing about.

We need urban scale empirical studies to comprehensively audit these wireless links.
%
Auditing can be performed through wireless scanning.
%
Wireless scans provide link layer information such as device names, MAC addresses, device type on discoverable/visible devices.
%
Additionally, the wireless signals (of the scan packets) received from the wireless devices can be analyzed to extract transmitter hardware properties at the physical layer.
%

Unfortunately, there is no prior empirical analysis that actually shows the feasibility of such scanning in real-world locations with tens of hundreds of other similar devices.
%
We don't have knowledge if the wireless scan information or even wireless signal properties are sufficient to uniquely identify a particular device in a sea of several devices.
%
As an example, even when our WiGLE scan data contained the Bluetooth skimmer, it was hard to differentiate from the tens of other Bluetooth devices at the gas station, because other infrastructure used the same Bluetooth devices.
%
Indeed, understanding the extent to which individual wireless links are distinguishable in real-world locations helps us quantify not only our ability to audit these links, but also understand whether an attacker can actually find these links to attacks.

Additionally, we also lack the tools to perform this wireless scanning over entire metro areas; existing scanners are too slow to reliably discover all wireless links using wardriving.
%
As a result, while we have public wireless scan datasets[cite wigle], they often miss devices and therefore don't provide a complete picture for wireless auditing.
%
For instance, I observed that a Bluetooth skimmer was recovered at a gas station on a particular day, and yet WiGle scan data from the same day missed that Bluetooth device. 
%




\begin{comment}
\section{Challenges}
Existing techniques are insufficient to audit the security and privacy threats of these wireless ad-hoc links, because of their inherent distributed and diverse nature. Indeed, these properties also complicate the design of new empirical methods and tools to achieve our goals of accurate and fast identification of wireless links.

The heterogeneity of these links makes it untenable to audit these links by simple vulnerability analysis of individual wireless devices[cite] that are used throughout an urban area. These links are extremely diverse – they are used in a wide variety of end applications (from personal devices to public infrastructure) across urban areas. In addition, there are a large number of vendors manufacturing the chipsets/devices used in these wireless links. Even for the same manufacturer, there are several different modules/chipsets  and even physical hardware variations within the same module (e.g. manufacturing variations in the clock crystal). Consequently, there are potentially thousands of different manufacturers and models of deployed ad-hoc links; a number of these are undocumented, and for a number of these we don’t even have the relevant user manuals to even begin to test the wireless device/chipset.

Any particular wireless device in the real world is hidden or obfuscated in the “noise” of several other wireless links around. There is minimal information available in wireless scans from device discovery packets. Wireless scanning uses information present in device discovery packets (e.g. inquiry request/response, advertisement beacons) to perform identification of wireless links. This process only provides us basic information like MAC addresses, a human-friendly name, type of device at the link layer. Identifying individual wireless links using just this information is like trying to find a needle in a haystack – there are millions of wireless links across personal devices and public infrastructure. At any real world location, we observe tens to hundreds of such wireless links making it difficult to pinpoint any one link. For example, 80\% of gas stations we observed had 15 different Bluetooth devices. Furthermore,  the exact same make and model of wireless device may be used in a diverse set of applications at the same location. For instance, we observed that at the same gas station, the exact same Bluetooth module was used in a speed sign, a traffic light as well as for an illegitimate skimmer at the gas station. Indeed this “hidden in the noise” problem has even led researchers to believe  that wireless scanning is insufficient to identify “hidden” wireless links [scaife oakland].

Even wireless hardware properties are ineffective at identifying or unobfuscating these ad-hoc links. We can measure wireless signal properties(e.g. CFO, CSI) from the received wireless scan packets. These wireless signal properties are due to manufacturing variations in the wireless hardware and therefore represent a particular

The distributed nature of these non-Internet connected links makes it impossible to audit them using existing wireless device fingerprinting techniques [cite Danny, Louis]. These links are geographically spread throughout cities and nations, and therefore there isn’t a central vantage point to observe the links. Wireless scanning through wardriving can be used to perform  measurement campaigns throughout large urban areas. Unfortunately, existing wardriving techniques are insufficient because wireless scanning is too slow to comprehensively discover all wireless links across entire metropolitan areas. The process of wireless scanning can take several tens of seconds to enumerate all wireless links nearby; this is too slow when scanning across urban areas in a moving vehicle and leads to missed devices, which can even be misconstrued as evidence of a device actually being hidden or obfuscated in the noise.





and perhaps some basic hardware signal properties like CFO, IQ offset at the physical layer.

hardware variations across two same devices very similar so hard to differentiate



we dont get the spatial context which can only be gotten by doing wardriving

Existing techniques for wireless device auditing,
\end{comment}

\section{Thesis}
In order to secure this "network" of non-Internet connected wireless ad-hoc links, we need to empirically understand if auditing using wireless scanning is indeed a feasible approach in real-world situations.
%
In this dissertation, I perform large scale empirical studies and design tools to quantitatively and qualitatively analyze the feasibility of performing wireless link auditing in real-world urban environments.
%
I perform wireless auditing measurement studies to analyze the effectiveness of auditing both from an attacker and a defensive perspective.
%
I then present the design of a tool to perform practical faster scanning of wireless links for wardriving applications
%
I argue that we can distinguish individual target wireless links even in the presence of several other links around, even with the limited information revealed by wireless scans.

Wireless access links found in urban areas use various types of communication protocols --- WiFi, Bluetooth, Zigbee and others
%
For this dissertation, I focus on empirical studies and tool design for Bluetooth-based links --- both Bluetooth Low Energy and Bluetooth Classic.
%
Indeed, Bluetooth is the most ubiquitous wireless ad-hoc  technology in use today, across personal devices, and public facing infrastructure.
%
In fact, its ubiquity and ease-of-use is what even prompted criminals to use it in gas pump skimmers.
%
While the empirical studies I present focus on Bluetooth scanning, wireless scanning is a fundamental feature of all wireless protocols, and scan information is very similar across protocols.
%
Thus, the lessons from my dissertation are universal, and apply to any type of wireless link.

In summary, I defend the following thesis statement:

\textit{It is feasible to uniquely audit a particular wireless access link in a real-world location surrounded by several such links by : 1) using wireless scan information collected through smartphone based scanning 2) using wireless signal information collected through commodity SDRs and 3) by designing a low-cost multi-channel scanning tool for fast wireless auditing}



\section{Contributions and Organization}
The remainder of this dissertation is organized as follows. 
%

Chapter 2 describes a large scale empirical study I performed over multiple states in the US, to understand the effectiveness of Bluetooth scanning from a smartphone for detection of Bluetooth credit card skimmers at a gas station. I find that Bluetooth characteristics of certain types of gas pump skimmers can be distinguished from other Bluetooth devices commonly seen at gas stations. In fact in a lot of cases Bluetooth scanning was then only source of information for investigators. Therefore, Bluetooth scanning is indeed an effective way to detect Bluetooth-based skimmers.
%

Chapter 3 describes an empirical study I performed over multiple real-world public locations, to evaluate an attacker's ability to track the location of a mobile device user by using the physical-layer imperfections of the Bluetooth transmitter. I observed that attackers can indeed use low-cost SDRs to obtain a physical-layer fingerprint and track a particular mobile device. However, in public locations I observed that certain mobile devices have very distinguishing physical-layer properties, whereas others have common fingerprints and are likely to be misidentified. Therefore, an attacker can track using physical layer properties, but their ability to do is a matter of luck. 
%

Chapter 4 describes a contribution to a larger project where I present the design of a low-cost portable SDR based fast classic Bluetooth scanning tool. This scanner improves Bluetooth scanning speed by a factor of 7x, significantly improving our coverage of Bluetooth devices when doing wardriving based wireless audits.

Chapter 3, in part, is a reprint of the material as it appears in \textit{Usenix Security Symposium 2019}. Nishant Bhaskar, Maxwell Bland, Kirill Levchenko, and Aaron Schulman. The dissertation author was the primary investigator and author of this paper.

Chapter 4, in part, is a reprint of the material as it appears in \textit{IEEE Symposium on Security and Privacy 2022}. Hadi Givehchian, Nishant Bhaskar, Eliana Rodriguez Herrera, Hector Rodrigo Lopez Soto, Christian Dameff, Dinesh Bharadia, Aaron Schulman. The dissertation author was a collaborator and contributor to the paper.